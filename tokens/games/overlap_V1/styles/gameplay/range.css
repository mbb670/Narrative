/* -----------------------------
Range
----------------------------- */

.range {
    border: var(--border-w) solid var(--color);
    pointer-events: none;
    background: color-mix(in srgb, color-mix(in srgb, var(--color), var(--background-default) 85%), transparent var(--range-transparency-pc));
    grid-column: var(--gs) / var(--ge);
    display: grid;
    grid-template-rows: subgrid;
    border-radius: var(--range-radius);
    position: relative;
    margin-right: calc(var(--border-w) * -0.75);
    box-shadow: var(--unit-12) var(--spacing-x16) var(--spacing-x48) 0 var(--color-alpha-black-a200);
    transition:
        opacity 650ms ease,
        border-color 650ms ease,
        background-color 650ms ease,
        box-shadow 650ms ease;
}

.range.range-solve-anim {
    animation: rangeSolve 850ms ease;
    will-change: box-shadow;
}

@keyframes rangeSolve {
    0% {
        box-shadow:
            inset 0 0 0 0 color-mix(in srgb, var(--color) 40%, transparent),
            0 0 0 0 color-mix(in srgb, var(--color) 20%, transparent);
    }

    45% {
        box-shadow:
            inset 0 0 0 144px color-mix(in srgb, var(--color) 35%, transparent),
            0 0 18px 6px color-mix(in srgb, var(--color) 35%, transparent);
    }

    100% {
        box-shadow:
            inset 0 0 0 144px color-mix(in srgb, var(--color) 0%, transparent),
            0 0 0 0 color-mix(in srgb, var(--color) 0%, transparent);
    }
}

/* Range focus overlay */
.range-focus {
    z-index: 10 !important;
    border: 4px solid var(--color);
    background: transparent;
    display: none !important;
    pointer-events: none;
    box-shadow: inset 0 0 var(--spacing-x16) var(--spacing-x16) color-mix(in srgb, var(--color) 16%, transparent);
}

.range-focus.is-active {
    display: grid !important;
}

.range-full {
    grid-row: 1 / -1;
    z-index: 1;
    --range-check-offset: -1;
}

.range-mid {
    grid-row: 2 / -2;
    z-index: 2;
    --range-check-offset: -2;
}

.range-inner {
    grid-row: 3 / -3;
    z-index: 3;
    --range-check-offset: -3;
}

.range.is-locked {
    box-shadow: none !important;

    &,
    &+.rangeClue :is(.rangeClue-string, .rangeClue-content) {
        opacity: 0.4;
        --color: var(--foreground-muted) !important;
        pointer-events: none;
        border-width: calc(var(--border-w)/2);
    }

    &+.rangeClue .rangeClue-content::after {
        content: '';
        display: block;
        aspect-ratio: 1;
        background-color: var(--foreground-muted);
        -webkit-mask: url("../../images/icons/circle-check.svg") center / contain no-repeat;
        mask: url("../../images/icons/circle-check.svg") center / contain no-repeat;
        padding: var(--spacing-x2) var(--spacing-x8);
    }
}


/* -----------------------------
Range Clues
----------------------------- */

.rangeClue {
    grid-row: 1/2;
    container-type: size;
    height: 100%;
    align-content: center;
    width: 100%;
    grid-column: var(--gs) / var(--ge);
    z-index: 20;
    pointer-events: none;

    .rangeClue-content {
        display: flex;
        position: sticky;
        left: 0;
        width: max-content;
        margin: 20cqmin;
        pointer-events: all;
        gap: var(--spacing-x4);

        button {
            color: color-mix(in srgb, var(--color), var(--foreground-default) 85%) !important;
            font-size: var(--range-clue-size);
            padding: var(--spacing-x2) var(--spacing-x8);
            white-space: nowrap;
            text-overflow: ellipsis;
            --background-color: color-mix(in srgb, var(--color), var(--background-default) 70%);
            border-radius: var(--radius-full);
            border: 0.5px solid var(--color);
            position: relative;

            &::before {
                content: '';
                width: 110%;
                height: 140%;
                position: absolute;
                top: -30%;
                left: -5%;
            }

        }

        &.is-hidden {
            display: none !important;
        }
    }
}

.rangeClue-hint {
    display: none;
    opacity: 0;
    transform: translateX(-12px);
    pointer-events: none;
    transition: opacity 160ms ease, transform 160ms ease;

    &::before {
        width: 140% !important;
        left: -20% !important;
    }

}

[data-game-state="paused"],
[data-game-state="idle"] {
    .rangeClue {
        display: none !important;
    }
}

[data-game-state="done"] {
    .rangeClue-content {
        pointer-events: none;
    }
}

.rangeClue.is-hint-visible .rangeClue-hint,
.rangeClue .rangeClue-content:focus-within .rangeClue-hint,
.rangeClue .rangeClue-string:focus-visible~.rangeClue-hint,
.rangeClue.is-hint-intro .rangeClue-hint {
    display: inline-flex;
    opacity: 1;
    transform: translateX(0);
    pointer-events: auto;
}

@media (hover: hover) {

    .rangeClue .rangeClue-content:hover .rangeClue-hint,
    .rangeClue .rangeClue-string:hover~.rangeClue-hint {
        display: inline-flex;
        opacity: 1;
        transform: translateX(0);
        pointer-events: auto;
    }
}

.rangeClue.is-hidden .rangeClue-hint {
    display: none !important;
}